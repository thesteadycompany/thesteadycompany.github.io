<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="최근 isowords 프로젝트를 보며기존의 멀티 패키지 구조를 단일 패키지 기반으로 병합해보기로 했다." />
    <meta name="author" content="Hogumachu" />
    <meta name="generator" content="Ignite v0.6.0" />
    <title>모듈 목적에 맞게 나누기 – The Steady Company</title>
    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/css/prism-xcode-dark.css" rel="stylesheet" data-highlight-theme="xcode-dark" />
    <link href="/css/prism-xcode-light.css" rel="stylesheet" data-highlight-theme="xcode-light" />
    <link href="/css/prism-plugins.css" rel="stylesheet" />
    <link href="/css/bootstrap-icons.min.css" rel="stylesheet" />
    <link href="/css/ignite-core.min.css" rel="stylesheet" />
    <link href="https://thesteadycompany.github.io/Garden/2025-01-14-module-by-purpose" rel="canonical" />
    <script>(function() {
    function getThemePreference() {
        return localStorage.getItem('custom-theme') || 'auto';
    }

    function applyTheme(themeID) {
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const lightThemeID = document.documentElement.getAttribute('data-light-theme') || 'light';
        const darkThemeID = document.documentElement.getAttribute('data-dark-theme') || 'dark';
        const actualThemeID = themeID === 'auto' ? (prefersDark ? darkThemeID : lightThemeID) : themeID;

        document.documentElement.setAttribute('data-bs-theme', actualThemeID);
        document.documentElement.setAttribute('data-theme-state', themeID);
    }

    function applySyntaxTheme() {
        const syntaxTheme = getComputedStyle(document.documentElement)
            .getPropertyValue('--syntax-highlight-theme').trim().replace(/"/g, '');

        if (!syntaxTheme) return;

        document.querySelectorAll('link[data-highlight-theme]').forEach(link => {
            link.setAttribute('disabled', 'disabled');
        });

        const themeLink = document.querySelector(`link[data-highlight-theme="${syntaxTheme}"]`);
        if (themeLink) {
            themeLink.removeAttribute('disabled');
        }
    }

    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
        const currentTheme = getThemePreference();
        if (currentTheme === 'auto') {
            applyTheme('auto');
            applySyntaxTheme();
        }
    });

    const savedTheme = getThemePreference();
    applyTheme(savedTheme);
    applySyntaxTheme();
})();
</script>
    <meta property="og:site_name" content="Docs" />
    <meta property="og:title" content="모듈 목적에 맞게 나누기" />
    <meta name="twitter:title" content="모듈 목적에 맞게 나누기" />
    <meta property="og:description" content="최근 isowords 프로젝트를 보며기존의 멀티 패키지 구조를 단일 패키지 기반으로 병합해보기로 했다." />
    <meta name="twitter:description" content="최근 isowords 프로젝트를 보며기존의 멀티 패키지 구조를 단일 패키지 기반으로 병합해보기로 했다." />
    <meta property="og:url" content="https://thesteadycompany.github.io/Garden/2025-01-14-module-by-purpose" />
    <meta name="twitter:domain" content="thesteadycompany.github.io" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:dnt" content="on" />
  </head>
  <body class="container">
    <div class="pb-5">
      <header>
        <nav class="fixed-top material-ultra-thin navbar navbar-expand-md">
          <div class="container flex-wrap flex-lg-nowrap">
            <div class="me-2 me-md-auto">
              <a href="/" class="d-inline-flex align-items-center navbar-brand"><span style="font-weight: 700; font-family: 'Space Grotesk'; font-size: 1.0em">THE STEADY COMPANY</span></a>
            </div>
            <button type="button" class="navbar-toggler btn" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
            <div id="navbarCollapse" class="collapse navbar-collapse">
              <ul class="navbar-nav mb-2 mb-md-0 col justify-content-end">
                <li class="nav-item"><a href="/garden-page" class="nav-link text-nowrap">Garden</a></li>
                <li class="nav-item"><a href="https://hogumachu.github.io" class="nav-link text-nowrap"><span>Personal Blog</span></a></li>
              </ul>
            </div>
          </div>
        </nav>
      </header>
    </div>
    <div class="ig-main-content">
      <h1 class="text-center text-primary pt-5">모듈 목적에 맞게 나누기</h1>
      <p class="text-center text-body-secondary pb-5">단일 패키지 실험과 멀티 패키지로의 회귀</p>
      <p class="m-3 p-3"></p>
      <p>최근 <a href="https://github.com/pointfreeco/isowords">isowords</a> 프로젝트를 보며<br />기존의 <strong>멀티 패키지 구조를 단일 패키지 기반으로 병합</strong>해보기로 했다.</p>
      <p>선택의 이유는 단순했다.</p>
      <ul>
        <li>패키지가 많아질수록 관리 포인트가 늘어난다</li>
        <li>단일 패키지로 합치면 구조 파악과 관리가 더 쉬워지지 않을까?</li>
        <li>디렉토리 구조를 활용해, 다른 언어처럼 파일 시스템 기반 import를 유기적으로 활용할 수 있지 않을까?</li>
      </ul>
      <p>결론부터 말하면, <strong>실패했다</strong>.</p>
      <hr />
      <h2>⚠️ 단일 패키지의 함정: 복잡도의 폭발</h2>
      <p>막상 단일 패키지로 합쳐보니<br />관리 포인트는 줄어들었지만, <strong>복잡도는 기하급수적으로 증가</strong>했다.</p>
      <ul>
        <li>의존성 경계가 흐려진다</li>
        <li>모듈 간 책임이 코드 레벨에서 강제되지 않는다</li>
        <li>“여기까지가 이 영역”이라는 감각이 점점 사라진다</li>
      </ul>
      <p>특히 기대했던</p>
      <blockquote>
        <p>“디렉토리 기반으로 유기적인 import가 가능하지 않을까?”</p>
      </blockquote>
      <p>라는 가설은 현실과 맞지 않았다.</p>
      <p>SwiftPM은 결국 <strong>Target 단위의 의존성 관리</strong>가 핵심이고,<br />디렉토리는 그저 정리 수단일 뿐이었다.</p>
      <hr />
      <h2>🔄 다시 멀티 패키지로</h2>
      <p>그래서 다시 <strong>멀티 패키지 구조</strong>로 돌아가기로 했다.</p>
      <p>다만, 이전과는 기준이 조금 달라졌다.</p>
      <h3>🎯 기준 1: Feature는 단일 패키지</h3>
      <p>Feature 단위는 여전히 하나의 패키지로 유지한다.<br />Feature 내부에서의 응집도가 가장 중요하다고 판단했기 때문이다.</p>
      <h3>🎯 기준 2: 외부 의존성이 강한 영역부터 분리</h3>
      <p>특히 다음과 같은 패키지들은 <strong>거의 코드 변경이 없고</strong>,<br />플랫폼 성격이 강했다.</p>
      <ul>
        <li>광고 패키지</li>
        <li>플랫폼 의존 패키지</li>
        <li>인증(Auth) 관련 패키지</li>
      </ul>
      <p>이런 패키지들은</p>
      <ul>
        <li>외부 라이브러리 의존성이 강하고</li>
        <li>다른 Feature들과의 결합도가 낮으며</li>
        <li>변경 가능성도 낮다</li>
      </ul>
      <p>그래서 <strong>패키지로 분리해 격리</strong>시키는 것이 더 합리적이었다.</p>
      <hr />
      <h2>🌱 AppFeature와 Composition Root의 고민</h2>
      <p>또 하나 고민이 있던 지점은<br /><code>AppFeature</code>라는 <strong>루트 역할 + Composition Root 역할</strong>을 하는 모듈이었다.</p>
      <p>현재 서비스는</p>
      <ul>
        <li>Dev</li>
        <li>Stage</li>
        <li>Production</li>
      </ul>
      <p><strong>멀티 타겟 환경</strong>으로 운영 중이다.</p>
      <p>문제는 이 환경 차이를<br /><code>Interface / Live</code> 구조로 나누기 애매한 영역이 점점 늘어난다는 점이었다.</p>
      <hr />
      <h2>💡 App 전용 패키지로의 분리 아이디어</h2>
      <p>그래서 든 생각은 이거였다.</p>
      <blockquote>
        <p>App 자체를 하나의 패키지로 보고<br />환경별 모듈을 그 안에서 명시적으로 나누면 어떨까?</p>
      </blockquote>
      <p>구조는 대략 이런 느낌이다.</p>
      <pre><code class="language-swift">.target(
  name: "AppFeature",
  dependencies: [
    /* App 공통 Feature */
  ]
),
.target(
  name: "AppDev",
  dependencies: [
    "AppFeature",
    /* Dev 전용 모듈 */
  ]
),
// AppStage, AppProduction...
</code></pre>
      <p>이렇게 하면 얻을 수 있는 장점은 꽤 명확하다.</p>
      <ul>
        <li>환경별 의존성이 코드 레벨에서 분리된다</li>
        <li>Dev 전용 도구(Playbook, Debug UI 등)는 <code>AppDev</code>에만 존재</li>
        <li>Stage / Production은 더 깔끔한 의존성 그래프 유지</li>
        <li>Composition Root의 책임이 명확해진다</li>
      </ul>
      <hr />
      <h2>🧠 모듈은 기술이 아니라 의도다</h2>
      <p>이번 구조 변경을 하면서 다시 느낀 점은 이거다.</p>
      <blockquote>
        <p>모듈은 “나누는 기술”이 아니라<br /><strong>의도를 강제하는 장치</strong>다.</p>
      </blockquote>
      <ul>
        <li>거의 변하지 않는 영역은 과감히 격리하고</li>
        <li>자주 변하는 영역은 응집도를 높이고</li>
        <li>환경 차이는 구조로 드러나게 만든다</li>
      </ul>
      <p>단일 패키지가 항상 정답은 아니고,<br />멀티 패키지도 무조건 복잡한 건 아니다.</p>
      <p><strong>중요한 건, 모듈이 왜 존재하는지 스스로 설명할 수 있느냐</strong>인 것 같다.</p>
      <p>이 구조도 언젠가는 다시 바뀔 수 있겠지만,<br />적어도 지금 기준에서는 꽤 합리적인 선택이라고 느낀다.</p>
      <p></p>
    </div>
    <div class="mt-5 fs-3 vstack gap-3">
      <div class="mb-0 align-self-center hstack gap-3">
        <a target="_blank" rel="noreferrer" href="https://github.com/thesteadycompany" class="mb-0 align-self-center link-secondary"><i class="bi-github"></i></a>
        <a target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/hogumachu/" class="mb-0 align-self-center link-secondary"><i class="bi-linkedin"></i></a>
      </div>
      <div class="mb-0 align-self-center">
        <div class="animation-sWfAv-hover" style="transform-style: preserve-3d">
          <div class="hstack gap-1">
            <div role="group" class="btn-group" aria-label="Theme Switch Buttons">
              <button type="button" class="btn" onclick="igniteSwitchTheme('light');"><i class="bi-sun-fill" style="color: rgb(255 255 255 / 70%)"></i></button>
              <button type="button" class="btn" onclick="igniteSwitchTheme('dark');"><i class="bi-moon-fill" style="color: rgb(0 0 0 / 70%)"></i></button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="/js/bootstrap.bundle.min.js"></script>
    <script src="/js/syntax-highlighting.js"></script>
    <script src="/js/ignite-core.js"></script>
  </body>
</html>